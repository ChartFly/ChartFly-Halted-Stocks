<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Halted Stocks Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .header {
            width: 100%;
            background: #333;
            color: white;
            padding: 15px 0;
            font-size: 22px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .header h1 {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .header img {
            width: 108px;
            height: 108px;
        }
        .tagline {
            font-size: 14px;
            text-align: center;
            color: #ddd;
        }
        .container {
            max-width: 1200px;
            margin: auto;
            background: white;
            padding: 20px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            width: 100%; /* Ensuring full width alignment */
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }
        th {
            background-color: #333;
            color: white;
        }
        .stock-input {
            margin-bottom: 10px;
            padding: 5px;
            width: calc(100% - 12px);
            display: block;
        }
        .holiday-schedule {
            width: 100%; /* Matches the halted stocks tracker width */
            margin-top: 20px;
            background: white;
            padding: 15px;
            border: 1px solid #ddd;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
            font-size: 12px;
            margin-bottom: 50px; /* Adds about 1 inch of space below the holidays table */
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>
            <img src="image.png" alt="ChartFly"> ChartFly
        </h1>
    </header>
    <p class="tagline">Educational tools and information for active day traders</p>
    
    <section id="market-status">
        <h2>Market Status</h2>
        <div class="market-status">Checking market status...</div>
        <h3>Upcoming Market Holidays</h3>
        <table class="holiday-schedule">
            <thead>
                <tr>
                    <th>January</th>
                    <th>February</th>
                    <th>March</th>
                    <th>April</th>
                    <th>May</th>
                    <th>June</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>New Year's Day<br>Jan 1 (Closed)</td>
                    <td>Presidents' Day<br>Feb 19 (Closed)</td>
                    <td>No Holiday</td>
                    <td>Good Friday<br>Mar 29 (Closed)</td>
                    <td>Memorial Day<br>May 27 (Closed)</td>
                    <td>No Holiday</td>
                </tr>
                <tr>
                    <th>July</th>
                    <th>August</th>
                    <th>September</th>
                    <th>October</th>
                    <th>November</th>
                    <th>December</th>
                </tr>
                <tr>
                    <td>Independence Day<br>Jul 4 (Closed)</td>
                    <td>No Holiday</td>
                    <td>Labor Day<br>Sep 2 (Closed)</td>
                    <td>No Holiday</td>
                    <td>Thanksgiving<br>Nov 28 (Closed)</td>
                    <td>Christmas<br>Dec 25 (Closed)</td>
                </tr>
            </tbody>
        </table>
    </section>

  <div class="container" style="font-size: 12px;">
        <h2 style="font-size: 12px;">Halted Stocks Tracker</h2>
        <table>
            <thead>
                <tr>
                    <th>Halt Date</th>
                    <th>Halt Time</th>
                    <th>Issue Symbol</th>
                    <th>Issue Name</th>
                    <th>Market</th>
                    <th>Reason Code</th>
                    <th>Definition</th>
                    <th>Halt Price</th>
                    <th>Res Date</th>
                    <th>Res Time</th>
                </tr>
            </thead>
            <tbody id="halted-stocks">
                <tr><td colspan="10">Loading halted stocks...</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        const NASDAQ_API_KEY = "1p8f1Jzx8f3qZfnnbeJA";
        const FINNHUB_API_KEY = "cv4gk8pr01qn2gaa2bfgcv4gk8pr01qn2gaa2bg0";

        async function fetchHaltedStocks() {
            try {
                const response = await fetch(`https://corsproxy.io/?https://api.nasdaq.com/api/marketmovers/halted`);
                const data = await response.json();
                const haltedStocks = data.data.halts;
                let tableBody = document.getElementById("halted-stocks");
                tableBody.innerHTML = "";

                haltedStocks.forEach(stock => {
                    let reasonDefinition = haltReasons[stock.reasonCode] || "Definition not available";
                    let row = `<tr>
                        <td>${stock.haltDate || ""}</td>
                        <td>${stock.haltTime || ""}</td>
                        <td>${stock.symbol || ""}</td>
                        <td>${stock.issueName || ""}</td>
                        <td>${stock.market || ""}</td>
                        <td>${stock.reasonCode || ""}</td>
                        <td>${reasonDefinition}</td>
                        <td>${stock.haltPrice || "N/A"}</td>
                        <td>${stock.resDate || "N/A"}</td>
                        <td>${stock.resTime || "N/A"}</td>
                    </tr>`;
                    tableBody.innerHTML += row;
                });
            } catch (error) {
                console.error("Error fetching halted stocks:", error);
                document.getElementById("halted-stocks").innerHTML = "<tr><td colspan='10'>Failed to load data.</td></tr>";
            }
        }

        fetchHaltedStocks();

         <div class="container" style="width: 100%; max-width: 1200px; font-size: 12px;">
    <h2>Stock Watchlist</h2>
    <input type="text" id="tickerInput" placeholder="Enter Ticker Symbol" style="font-size: 12px; padding: 5px;">
    <button onclick="addTicker()" style="font-size: 12px; padding: 5px;">Add</button>
    
    <!-- Watchlist Table: 1 row high, 10 columns wide -->
    <table id="watchlist" style="width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 12px;">
        <thead>
            <tr>
                <th>Symbol</th>
                <th>Current</th>
                <th>Open</th>
                <th>High</th>
                <th>Low</th>
                <th>Prev Close</th>
                <th>Market Cap</th>
                <th>P/E Ratio</th>
                <th>EPS</th>
                <th>52W High</th>
            </tr>
        </thead>
        <tbody>
            <!-- Watchlist tickers will be added here dynamically -->
        </tbody>
    </table>
</div>

<!-- 1-inch gap between tables -->
<div style="height: 50px;"></div>

<!-- Metrics Table: At least 13-20 columns, matches Halted Stocks Tracker width -->
<div class="container" style="width: 100%; max-width: 1200px; font-size: 12px;">
    <h2>Stock Metrics</h2>
    <table id="stock-metrics" style="width: 100%; border-collapse: collapse; font-size: 12px;">
        <thead>
            <tr>
                <th>Symbol</th>
                <th>Current Price</th>
                <th>Open</th>
                <th>High</th>
                <th>Low</th>
                <th>Prev Close</th>
                <th>Market Cap</th>
                <th>Shares Out</th>
                <th>P/E Ratio</th>
                <th>EPS</th>
                <th>52W High</th>
                <th>52W Low</th>
                <th>Dividend Yield</th>
                <th>Short Interest</th>
                <th>Recent News</th>
            </tr>
        </thead>
        <tbody>
            <!-- Stock Metrics data will be added here dynamically -->
        </tbody>
    </table>
</div>

<script>
    // âœ… Stock Watchlist Logic is Now Included Below
    const watchlist = [];

    function addTicker() {
        const tickerInput = document.getElementById("tickerInput");
        const ticker = tickerInput.value.trim().toUpperCase();
        if (ticker && !watchlist.includes(ticker)) {
            watchlist.push(ticker);
            fetchStockData(ticker);
        }
        tickerInput.value = "";
    }

    document.getElementById("tickerInput").addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
            addTicker();
        }
    });

    async function fetchStockData(ticker) {
        const STOCK_API_URL = `https://finnhub.io/api/v1/quote?symbol=${ticker}&token=${FINNHUB_API_KEY}`;
        const PROFILE_API_URL = `https://finnhub.io/api/v1/stock/profile2?symbol=${ticker}&token=${FINNHUB_API_KEY}`;
        const METRIC_API_URL = `https://finnhub.io/api/v1/stock/metric?symbol=${ticker}&metric=all&token=${FINNHUB_API_KEY}`;
        const NEWS_API_URL = `https://finnhub.io/api/v1/company-news?symbol=${ticker}&from=${getPastDate(30)}&to=${getTodayDate()}&token=${FINNHUB_API_KEY}`;
        
        try {
            const [quoteRes, profileRes, metricRes, newsRes] = await Promise.all([
                fetch(STOCK_API_URL),
                fetch(PROFILE_API_URL),
                fetch(METRIC_API_URL),
                fetch(NEWS_API_URL)
            ]);
            
            if (!quoteRes.ok || !profileRes.ok || !metricRes.ok || !newsRes.ok) {
                throw new Error("One or more API requests failed");
            }
            
            const [quoteData, profileData, metricData, newsData] = await Promise.all([
                quoteRes.json(),
                profileRes.json(),
                metricRes.json(),
                newsRes.json()
            ]);

            updateMetrics(ticker, quoteData, profileData, metricData, newsData);
        } catch (error) {
            console.error("Error fetching stock data:", error);
        }
    }

    function updateMetrics(ticker, quote, profile, metric, news) {
        const tableBody = document.querySelector("#stock-metrics tbody");
        const row = `<tr style="font-size: 12px;">
            <td>${ticker}</td>
            <td>${quote.c ? `$${quote.c.toFixed(2)}` : "N/A"}</td>
            <td>${quote.o ? `$${quote.o.toFixed(2)}` : "N/A"}</td>
            <td>${quote.h ? `$${quote.h.toFixed(2)}` : "N/A"}</td>
            <td>${quote.l ? `$${quote.l.toFixed(2)}` : "N/A"}</td>
            <td>${quote.pc ? `$${quote.pc.toFixed(2)}` : "N/A"}</td>
            <td>${metric.metric.marketCapitalization ? `$${metric.metric.marketCapitalization.toFixed(2)}B` : "N/A"}</td>
            <td>${metric.metric.shareOutstanding ? `${metric.metric.shareOutstanding.toFixed(2)}M` : "N/A"}</td>
            <td>${metric.metric.peRatio ? metric.metric.peRatio.toFixed(2) : "N/A"}</td>
            <td>${metric.metric.eps ? `$${metric.metric.eps.toFixed(2)}` : "N/A"}</td>
            <td>${metric.metric.52WeekHigh ? `$${metric.metric["52WeekHigh"].toFixed(2)}` : "N/A"}</td>
            <td>${metric.metric.52WeekLow ? `$${metric.metric["52WeekLow"].toFixed(2)}` : "N/A"}</td>
            <td>${metric.metric.dividendYield ? `${(metric.metric.dividendYield * 100).toFixed(2)}%` : "N/A"}</td>
            <td>${metric.metric.shortInterest ? `${metric.metric.shortInterest.toFixed(2)}M` : "N/A"}</td>
            <td>${getLatestNews(news)}</td>
        </tr>`;
        tableBody.innerHTML += row;
    }
</script>
</body>
</html>
  